{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "fileupload",
  "type": "registry:ui",
  "title": "fileupload",
  "description": "file upload component that you can use to upload files to your server",
  "dependencies": [
    "lucide-react"
  ],
  "files": [
    {
      "path": "src/components/fileupload.tsx",
      "content": "\"use client\"\n\nimport {\n  createContext,\n  useContext,\n  useState,\n  useRef,\n  useEffect,\n  type DragEvent,\n  type ChangeEvent,\n  type ReactNode,\n  type HTMLAttributes,\n} from \"react\"\nimport { Upload, X, FileIcon } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\ninterface FileUploadContextValue {\n  file: File | null\n  preview: string | null\n  isDragging: boolean\n  clear: () => void\n  openLightbox: () => void\n}\n\nconst FileUploadContext = createContext<FileUploadContextValue | null>(null)\n\ninterface FileUploadProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n  accept?: string\n  onChange?: (file: File | null) => void\n}\n\nfunction FileUpload({ accept = \"*\", onChange, className, children, ...props }: FileUploadProps) {\n  const [file, setFile] = useState<File | null>(null)\n  const [preview, setPreview] = useState<string | null>(null)\n  const [isDragging, setIsDragging] = useState(false)\n  const [lightbox, setLightbox] = useState(false)\n  const inputRef = useRef<HTMLInputElement>(null)\n\n  const handleFile = (f: File | null) => {\n    if (preview?.startsWith(\"blob:\")) URL.revokeObjectURL(preview)\n    setFile(f)\n    onChange?.(f)\n    if (!f) return setPreview(null)\n    if (f.type.startsWith(\"image/\")) {\n      const reader = new FileReader()\n      reader.onload = (e) => setPreview(e.target?.result as string)\n      reader.readAsDataURL(f)\n    } else if (f.type === \"application/pdf\") {\n      setPreview(URL.createObjectURL(f))\n    } else {\n      setPreview(null)\n    }\n  }\n\n  const clear = () => {\n    handleFile(null)\n    if (inputRef.current) inputRef.current.value = \"\"\n  }\n\n  return (\n    <FileUploadContext.Provider\n      value={{ file, preview, isDragging, clear, openLightbox: () => setLightbox(true) }}\n    >\n      <div\n        onClick={() => inputRef.current?.click()}\n        onDrop={(e: DragEvent) => {\n          e.preventDefault()\n          setIsDragging(false)\n          const f = e.dataTransfer.files[0]\n          if (f) handleFile(f)\n        }}\n        onDragOver={(e: DragEvent) => {\n          e.preventDefault()\n          setIsDragging(true)\n        }}\n        onDragLeave={() => setIsDragging(false)}\n        className={cn(\n          \"relative flex min-h-48 cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed p-6 transition-colors\",\n          isDragging ? \"border-blue-500 bg-blue-500/10\" : \"border-muted-foreground/25 hover:border-primary/50\",\n          className\n        )}\n        {...props}\n      >\n        <input\n          ref={inputRef}\n          type=\"file\"\n          accept={accept}\n          onChange={(e: ChangeEvent<HTMLInputElement>) => {\n            const f = e.target.files?.[0]\n            if (f) handleFile(f)\n          }}\n          className=\"hidden\"\n        />\n        {children}\n      </div>\n\n      {lightbox && preview && (\n        <Lightbox src={preview} isPdf={file?.type === \"application/pdf\"} onClose={() => setLightbox(false)} />\n      )}\n    </FileUploadContext.Provider>\n  )\n}\n\nfunction FileUploadContent({ children }: { children?: ReactNode }) {\n  const ctx = useContext(FileUploadContext)\n  if (!ctx) throw new Error(\"FileUploadContent must be used within FileUpload\")\n\n  const { file, preview, clear, openLightbox } = ctx\n\n  if (!file) {\n    return (\n      children ?? (\n        <div className=\"flex flex-col items-center gap-2 text-muted-foreground\">\n          <Upload className=\"size-8\" />\n          <span className=\"text-sm\">Click or drag file to upload</span>\n        </div>\n      )\n    )\n  }\n\n  const isImage = file.type.startsWith(\"image/\")\n  const isPdf = file.type === \"application/pdf\"\n\n  return (\n    <div className=\"relative\" onClick={(e) => e.stopPropagation()}>\n      {isImage && preview ? (\n        <img\n          src={preview}\n          alt=\"Preview\"\n          className=\"max-h-40 cursor-zoom-in rounded-md object-contain\"\n          onClick={openLightbox}\n        />\n      ) : isPdf && preview ? (\n        <div className=\"relative h-40 w-64 cursor-zoom-in\" onClick={openLightbox}>\n          <iframe src={preview} title=\"PDF Preview\" className=\"pointer-events-none h-full w-full rounded-md border\" />\n        </div>\n      ) : (\n        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n          <FileIcon className=\"size-4\" />\n          <span>{file.name}</span>\n        </div>\n      )}\n      <button\n        onClick={(e) => {\n          e.stopPropagation()\n          clear()\n        }}\n        className=\"absolute -right-2 -top-2 grid size-6 place-items-center rounded-full bg-white/10 text-white hover:bg-white/20\"\n      >\n        <X className=\"size-3\" />\n      </button>\n    </div>\n  )\n}\n\nfunction Lightbox({ src, isPdf, onClose }: { src: string; isPdf?: boolean; onClose: () => void }) {\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") onClose()\n    }\n    document.addEventListener(\"keydown\", handleKeyDown)\n    return () => document.removeEventListener(\"keydown\", handleKeyDown)\n  }, [onClose])\n\n  return (\n    <div className=\"fixed inset-0 z-50 grid place-items-center bg-black/80 backdrop-blur-sm\" onClick={onClose}>\n      {isPdf ? (\n        <iframe\n          src={src}\n          title=\"PDF Preview\"\n          className=\"h-[90vh] w-[90vw] rounded-lg\"\n          onClick={(e) => e.stopPropagation()}\n        />\n      ) : (\n        <img src={src} alt=\"Full preview\" className=\"max-h-[90vh] max-w-[90vw] rounded-lg object-contain\" />\n      )}\n      <button\n        onClick={onClose}\n        className=\"absolute right-4 top-4 grid size-10 place-items-center rounded-full bg-white/10 text-white hover:bg-white/20\"\n      >\n        <X className=\"size-5\" />\n      </button>\n    </div>\n  )\n}\n\nexport { FileUpload, FileUploadContent }\n",
      "type": "registry:ui",
      "target": ""
    }
  ]
}